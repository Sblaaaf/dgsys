/* === Section Métiers Carousel (V3) === */

.metiers-carousel-section {
  width: 100%;
  padding: 0;
  margin-top: 2rem;
  overflow: hidden;
}

.carousel-wrapper {
  position: relative;
  
  --active-card-height: 400px;
  width: 100%;
  height: auto;
  min-height: 450px;
  transition: min-height 0.6s ease, height 0.6s ease;
  justify-content: center;
  align-items: center;
  z-index: 20;
}

.carousel-track {
  position: relative;
  width: 100%;
  height: 100%;
  perspective: 1500px;
}

.carousel-card {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 320px;
  height: auto;
  min-height: 320px;
  background-color: white;
  border: 1px solid var(--pri);
  border-radius: 1.5rem;
  box-shadow: 0 10px 30px rgba(33, 54, 106, 0.1);
  cursor: pointer;
  transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  text-align: center;
}

/* Appliquer l'image de fond et l'overlay aux cartes métiers */
.carousel-card:not(.master-card) {
  background-image: var(--bg-image);
  background-size: cover;
  background-position: center;
}

.carousel-card:not(.master-card)::before {
  content: '';
  position: absolute;
  inset: 0;
  background-color: var(--sec);
  border-radius: inherit;
  z-index: 1;
}

/* Supprimer l'overlay de la carte active pour rendre l'image de fond visible */
.carousel-card.active:not(.master-card)::before {
  opacity: 0;
}

/* Superposition sombre pour les cartes inactives */
.carousel-card::after {
  content: '';
  position: absolute;
  inset: 0;
  background-color: rgba(33, 54, 106, 0.3);
  border-radius: inherit;
  transition: opacity 0.6s ease;
  opacity: 1;
  z-index: 2;
}

.card-content {
  z-index: 3;
  position: relative;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
}

.card-content i {
  font-size: 2rem;
  color: var(--pri)ri);
  transition: transform 0.5s ease;
}

.card-content h3 {
  font-size: 1.3rem;
  font-weight: 800;
  color: white;
  margin: 0;
  transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
  transform-origin: center;
}

.card-content p {
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.9);
  line-height: 1.5;
  margin: 0;
  transition: opacity 0.4s ease;
}

/* --- Positionnement des cartes --- */

/* Carte Active (Centre) */
.carousel-card.active {
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
  z-index: 10;
  cursor: default;
  border-color: var(--pri);
  filter: blur(0);
  min-height: var(--active-card-height);
  min-width: 700px;
}

/* Cache l'overlay sur la carte active */
.carousel-card.active::after {
  opacity: 0;
}

/* Rétablir les styles pour la carte active */
.carousel-card.active .card-content {
  flex-direction: column;
}

.carousel-card.active .card-content h3 {
  transform: rotateX(0deg);
}

.carousel-card:not(.active) .card-content p {
  display: none;
}

/* ====== Cartes inactives ====== */

/* Style commun pour le contenu des cartes inactives */
.carousel-card.prev-1 .card-content,
.carousel-card.prev-2 .card-content,
.carousel-card.prev-3 .card-content,
.carousel-card.next-1 .card-content,
.carousel-card.next-2 .card-content,
.carousel-card.next-3 .card-content {
  position: absolute;
  bottom: 1.5rem;
  writing-mode: vertical-rl; /* Affiche le texte à la verticale */
  transform: rotate(180deg); /* Redresse le texte qui est à l'envers par défaut */
  align-items: center;
  justify-content: center;
  gap: 1rem;
  padding: 0;
}

/* Redresse les icônes */
.carousel-card.prev-1 .card-content i,
.carousel-card.prev-2 .card-content i,
.carousel-card.prev-3 .card-content i,
.carousel-card.next-1 .card-content i,
.carousel-card.next-2 .card-content i,
.carousel-card.next-3 .card-content i {
    transform: rotate(180deg); 
}

/* Spécifique aux cartes de GAUCHE (prev) */
.carousel-card.prev-1 .card-content,
.carousel-card.prev-2 .card-content,
.carousel-card.prev-3 .card-content {
  left: 1.5rem;
}

/* Spécifique aux cartes de DROITE (next) */
.carousel-card.next-1 .card-content,
.carousel-card.next-2 .card-content,
.carousel-card.next-3 .card-content {
  right: 1.5rem;
  flex-direction: row;
}

/* === Styles spécifiques pour la Master Card === */

.carousel-card.master-card {
  min-width: 700px;
  min-height: var(--active-card-height);
  padding: 1.5rem;
}

.carousel-card.master-card .card-content {
  margin: 0 auto;
  display: flex;
  gap: 0.75rem;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
}

/* Rétablir les couleurs par défaut pour le contenu de la master-card */
.carousel-card.master-card .card-content i {
  color: var(--pri);
}

.carousel-card.master-card .card-content h3,
.carousel-card.master-card .section-title {
  color: var(--sec);
}

.carousel-card.master-card .card-content p,
.carousel-card.master-card .metiers-intro-text {
  color: var(--text);
}

.carousel-card.master-card .metiers-intro-text {
  text-align: center;
}

.carousel-card.master-card::after {
  opacity: 0;
}

.master-card-links-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(85px, 1fr));
  gap: 0.4rem;
  width: 100%;
}

.master-card-link {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 0.6rem;
  border: 1px solid var(--border-gray);
  border-radius: 0.75rem;
  text-decoration: none;
  color: var(--sec);
  font-size: 0.75rem;
  transition: all 0.3s ease;
}

.master-card-link i {
  font-size: 1.5rem;
  margin-bottom: 0.3rem;
}

.master-card-link:hover {
  background-color: var(--ter);
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 174, 232, 0.1);
}

/* Cartes adjacentes (Niveau 1) */
.carousel-card.prev-1 {
  transform: translate(calc(-50% - 300px), -50%) scale(1);
  filter: blur(0px);
  z-index: 8;
}

.carousel-card.next-1 {
  transform: translate(calc(-50% + 300px), -50%) scale(1);
  filter: blur(0px);
  z-index: 8;
}

.carousel-card.prev-1::after,
.carousel-card.next-1::after {
  opacity: 0.4;
}

/* Cartes éloignées (Niveau 2) */
.carousel-card.prev-2 {
  transform: translate(calc(-50% - 420px), -50%) scale(0.9);
  filter: blur(1px);
  z-index: 6;
}

.carousel-card.next-2 {
  transform: translate(calc(-50% + 420px), -50%) scale(0.9);
  filter: blur(1px);
  z-index: 6;
}

.carousel-card.prev-2::after,
.carousel-card.next-2::after {
  opacity: 0.6;
}

/* Cartes très éloignées (Niveau 3) */
.carousel-card.prev-3 {
  transform: translate(calc(-50% - 520px), -50%) scale(0.8);
  filter: blur(2px);
  z-index: 4;
}

.carousel-card.next-3 {
  transform: translate(calc(-50% + 520px), -50%) scale(0.8);
  filter: blur(2px);
  z-index: 4;
}

.carousel-card.prev-3::after,
.carousel-card.next-3::after {
  opacity: 0.8;
}

/* Cartes cachées */
.carousel-card.hidden {
  transform: translate(-50%, -50%) scale(0.5);
  filter: blur(8px);
  opacity: 0;
  z-index: 0;
  pointer-events: none;
}

/* Classe pour forcer le masquage de la master-card via JS */
.carousel-card.is-hidden-by-user {
  display: none !important;
}

/* --- Contrôles (flèches) --- */

.carousel-controls {
  position: absolute;
  top: calc(50% - 2rem);
  left: 50%;
  transform: translateX(-50%);
  width: calc(700px + 3.5rem);
  display: flex;
  justify-content: space-between;
  align-items: center;
  pointer-events: none;
  z-index: 20;
}

.carousel-arrow {
  pointer-events: auto;
  background-color: var(--sec);
  border: 1px solid var(--pri);
  border-radius: 50%;
  width: 3.5rem;
  height: 3.5rem;
  cursor: pointer;
  font-size: 1.2rem;
  color: white;
  box-shadow: 0 5px 20px rgba(0,0,0,0.08);
  transition: all 0.3s ease;
}

.carousel-arrow:hover {
  background-color: white;
  color: var(--sec);
  transform: scale(1.1);
}

/* Style pour le bouton "Choisir" */
#show-master-card-btn {
  position: absolute;
  display: flex;
  align-items: center;
  text-transform: uppercase;
  font-size: 0.7rem;
  color: var(--pri);
  gap: 0.5rem;
  background-color: white;
  border: 1px solid var(--pri);
  border-radius: 2rem;
  top: calc(50% - ((var(--active-card-height) / 2) - 1.5rem));
  left: 50%;
  transform: translate(-50%, -100%);
  pointer-events: auto;
  transition: opacity 0.4s ease, transform 0.4s ease;
}

#show-master-card-btn:hover {
  background-color: var(--sec);
  color: white;
}

/* Classe pour masquer/afficher le bouton */
.is-user-hidden {
  opacity: 0;
  pointer-events: none;
  transform: scale(0.9);
}

/* --- Responsive Design --- */

/* Tablettes (entre 768px et 1200px) - Affichage de 5 cartes */
@media (max-width: 1200px) {
  .carousel-wrapper {
    --active-card-height: 380px;
    min-height: 430px;
  }

  .carousel-card.active {
    min-width: 550px;
  }

  .carousel-card.prev-1 { transform: translate(calc(-50% - 210px), -50%) scale(0.9); }
  .carousel-card.next-1 { transform: translate(calc(-50% + 210px), -50%) scale(0.9); }

  /* Niveau 2 */
  .carousel-card.prev-2 { transform: translate(calc(-50% - 320px), -50%) scale(0.7); }
  .carousel-card.next-2 { transform: translate(calc(-50% + 320px), -50%) scale(0.7); }

  /* On cache le niveau 3 */
  .carousel-card.prev-3,
  .carousel-card.next-3 {
    transform: translate(calc(-50% - 450px), -50%) scale(0.5);
    opacity: 0;
    pointer-events: none;
  }

  .carousel-card.next-3 {
    transform: translate(calc(-50% + 450px), -50%) scale(0.5);
  }

  .carousel-controls {
    padding: 0;
    position: absolute;
    top: calc(50% - 2rem);
    left: 50%;
    transform: translateX(-50%);
    width: calc(550px + 3.5rem);
    display: flex;
    justify-content: space-between;
    align-items: center;
    pointer-events: none;
    z-index: 20;
  }
}

/* Mobiles (moins de 768px) - Affichage de 3 cartes */
@media (max-width: 767px) {
  .carousel-wrapper {
    --active-card-height: 340px;
    min-height: 390px;
  }

  .metiers-carousel-section {
    padding: 3rem 0;
  }

  .carousel-wrapper {
    height: auto;
  }

  .carousel-card {
    width: 65vw;
    height: auto;
    min-height: 280px;
    padding: 1.5rem;
  }

  .carousel-card.active {
    min-width: 85vw;
    width: 85vw;
  }

  .carousel-card.master-card {
    min-width: 85vw;
    padding: 2rem;
  }

  .card-content h3 {
    font-size: 1.2rem;
  }

  .card-content p {
    font-size: 0.85rem;
  }

  /* --- Positionnement pour 3 cartes visibles --- */

  /* Niveau 1 */
  .carousel-card.prev-1 {
    transform: translate(calc(-50% - 22vw), -50%) scale(0.8);
    z-index: 8;
  }

  .carousel-card.next-1 {
    transform: translate(calc(-50% + 22vw), -50%) scale(0.8);
    z-index: 8;
  }

  .carousel-card.prev-1 h3,
  .carousel-card.next-1 h3 {
    opacity: 0;
  }
  .carousel-card.prev-1 i,
  .carousel-card.next-1 i {
    opacity: 0;
  }

  .carousel-card.prev-1::after,
  .carousel-card.next-1::after {
    opacity: 0.4;
  }

  /* On cache tous les autres niveaux */
  .carousel-card.prev-2,
  .carousel-card.next-2,
  .carousel-card.prev-3,
  .carousel-card.next-3 {
    transform: translate(-50%, -50%) scale(0.5);
    opacity: 0;
    pointer-events: none;
  }

  /* --- Contrôles sur mobile --- */

  .carousel-controls {
    top: 50%;
    left: 50%;
    min-width: calc(85vw + 2rem);
    max-width: calc(85vw + 2rem);
    transform: translate(-50%, -50%);
    gap: 1rem;
  }

  .carousel-arrow {
    width: 2rem;
    height: 2rem;
    font-size: 0.8rem;
  }

  #show-master-card-btn {
    left: 50%;
    width: 70%;
    transform: translate(-50%, -100%);
    justify-content: center;
    padding: 0.5rem 1rem;
  }

  /* Ajustements pour le titre et le texte d'intro dans la master card sur mobile */
  .carousel-card.master-card .section-title {
    font-size: 1.8rem;
  }

  .carousel-card.master-card .metiers-intro-text {
    font-size: 0.9rem;
  }
}


